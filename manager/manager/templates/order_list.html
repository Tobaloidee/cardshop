{% extends "base.html" %}
{% load manager %}

{% block content %}
<h2>{{ user.profile.organization }}'s Orders</h2>
<p class="info">Requests for creation of an actual Hotspot Image, either prepared for Download or physical sent by mail as a micro-SD card.</p>
<p><div class="btn-group" role="group" aria-label="Filter">
	<a class="btn btn-sm {% if order_filter == "in-progress" %} btn-secondary{% else %}btn-outline-secondary{% endif %}"  href="?only=in-progress">In Progress</a>
	<a class="btn btn-sm {% if order_filter == "failed" %} btn-secondary{% else %}btn-outline-secondary{% endif %}" href="?only=failed">Failed</a>
	<a class="btn btn-sm {% if order_filter == "completed" %} btn-secondary{% else %}btn-outline-secondary{% endif %}" href="?only=completed">Completed</a>
</div><a href="{% url 'order_new' %}" class="btn btn-sm btn-primary float-right">Place An Order</a></p>

{% if orders %}
<table class="table table-striped">
	<thead><tr><th>ID</th><th>Name</th><th>Country</th><th>Created By</th><th>Created On</th><th>Status</th></tr></thead>
	<tbody>
	{% for order in orders %}
	<tr><th><a href="{% url 'order_detail' order_min_id=order.min_id %}">{{ order.min_id }}</a></th>
		<td>{{ order.data.config_name }}</td>
		<td>{{ order.data.recipient.country|country }}</td>
		<td>{{ order.created_by.name }}</td>
		<td>{{ order.created_on }}</td>
		<td class="{{ order.status|status_color }}">{{ order.verbose_status }}</td>
	</tr>
	{% endfor %}
	</tbody>
</table>
{% if orders_page.has_previous or orders_page.has_next %}
<div class="pagination">
    <span class="step-links">
        {% if orders_page.has_previous %}
            <a href="?only={{ order_filter }}&page=1">&laquo; first</a>
            <a href="?only={{ order_filter }}&page={{ orders_page.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ orders_page.number }} of {{ orders_page.paginator.num_pages }}.
        </span>

        {% if orders_page.has_next %}
            <a href="?only={{ order_filter }}&page={{ orders_page.next_page_number }}">next</a>
            <a href="?only={{ order_filter }}&page={{ orders_page.paginator.num_pages }}">last &raquo;</a>
        {% endif %}
    </span>
</div>
{% endif %}
{% else %}
<p class="info">There's no <em>{{ order_filter }}</em> order yet. Place one !</p>
{% endif %}
{% endblock %}

{% block javascript %}
	$('[data-toggle="popover"]').popover();
{% endblock %}
